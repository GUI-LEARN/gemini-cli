# Gemini CLI Architecture Diagram

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                              TERMINAL / USER                                 │
└────────────────────────────────┬────────────────────────────────────────────┘
                                 │
┌────────────────────────────────┴─────────────────────────────────────────────┐
│                           packages/cli/ (Frontend)                           │
│  ┌─────────────────────────────────────────────────────────────────────────┐  │
│  │  React + Ink Terminal UI                                                │  │
│  │  ┌─────────────┐  ┌──────────────┐  ┌─────────────┐  ┌──────────────┐  │  │
│  │  │   App.tsx   │  │   Header     │  │   Footer    │  │  Commands    │  │  │
│  │  └─────────────┘  └──────────────┘  └─────────────┘  └──────────────┘  │  │
│  │                                                                         │  │
│  │  ┌─────────────────────────────────────────────────────────────────┐   │  │
│  │  │                    UI Components                                │   │  │
│  │  │  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌────────────┐      │   │  │
│  │  │  │Messages  │  │History   │  │Themes    │  │Auth Dialog │      │   │  │
│  │  │  └──────────┘  └──────────┘  └──────────┘  └────────────┘      │   │  │
│  │  └─────────────────────────────────────────────────────────────────┘   │  │
│  └─────────────────────────────────────────────────────────────────────────┘  │
└───────────────────────────────────────────────────────────────────────────────┘
                                 │ JSON-RPC / API
┌────────────────────────────────┴─────────────────────────────────────────────┐
│                           packages/core/ (Backend)                           │
│  ┌─────────────────────────────────────────────────────────────────────────┐  │
│  │  Core Engine                                                            │  │
│  │  ┌─────────────────┐  ┌─────────────────┐  ┌────────────────────┐      │  │
│  │  │Gemini API Client│  │Tool Orchestrator│  │Session Management  │      │  │
│  │  └─────────────────┘  └─────────────────┘  └────────────────────┘      │  │
│  │                                                                         │  │
│  │  ┌─────────────────────────────────────────────────────────────────┐   │  │
│  │  │                    Tools System                                  │   │  │
│  │  │  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌────────────┐      │   │  │
│  │  │  │File Ops  │  │Shell     │  │Web Search│  │Memory      │      │   │  │
│  │  │  └──────────┘  └──────────┘  └──────────┘  └────────────┘      │   │  │
│  │  │  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌────────────┐      │   │  │
│  │  │  │MCP Client│  │Web Fetch │  │Git       │  │Code Assist │      │   │  │
│  │  │  └──────────┘  └──────────┘  └──────────┘  └────────────┘      │   │  │
│  │  └─────────────────────────────────────────────────────────────────┘   │  │
│  │                                                                         │  │
│  │  ┌─────────────────────────────────────────────────────────────────┐   │  │
│  │  │                External Services                                │   │  │
│  │  │  ┌──────────────┐  ┌─────────────┐  ┌────────────────┐        │   │  │
│  │  │  │Google Gemini │  │Vertex AI    │  │Google Search   │        │   │  │
│  │  │  │API           │  │API          │  │Grounding Tool  │        │   │  │
│  │  │  └──────────────┘  └─────────────┘  └────────────────┘        │   │  │
│  │  └─────────────────────────────────────────────────────────────────┘   │  │
│  └─────────────────────────────────────────────────────────────────────────┘  │
└───────────────────────────────────────────────────────────────────────────────┘
                                 │
┌────────────────────────────────┴─────────────────────────────────────────────┐
│                              SANDBOX LAYER                                   │
│  ┌─────────────────────────────────────────────────────────────────────────┐  │
│  │  Security Isolation                                                     │  │
│  │  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐                 │  │
│  │  │Docker        │  │Podman        │  │MacOS Seatbelt│                 │  │
│  │  │Container     │  │Container     │  │Sandbox      │                 │  │
│  │  └──────────────┘  └──────────────┘  └──────────────┘                 │  │
│  └─────────────────────────────────────────────────────────────────────────┘  │
└───────────────────────────────────────────────────────────────────────────────┘
                                 │
┌────────────────────────────────┴─────────────────────────────────────────────┐
│                         FILE SYSTEM / ENVIRONMENT                            │
│  ┌─────────────────────────────────────────────────────────────────────────┐  │
│  │  User's local system:                                                  │  │
│  │  ┌────────────┐  ┌────────────┐  ┌────────────┐  ┌────────────────┐   │  │
│  │  │Project     │  │Git         │  │Shell       │  │Network/Internet│   │  │
│  │  │Files       │  │Repository  │  │Commands    │  │Access         │   │  │
│  │  └────────────┘  └────────────┘  └────────────┘  └────────────────┘   │  │
│  └─────────────────────────────────────────────────────────────────────────┘  │
└───────────────────────────────────────────────────────────────────────────────┘
```

## Data Flow

```
1. User Input → CLI Frontend (React/TypeScript)
2. CLI → Core Backend (JSON-RPC/API calls)
3. Core → Gemini API (HTTP requests)
4. Gemini → Tool Requests → Core Tool Orchestrator
5. Tools → File System/Shell/Network Operations
6. Results → Core → CLI → Terminal Display
```

## Key Technologies

- **Frontend**: React, Ink (terminal UI), TypeScript
- **Backend**: Node.js, TypeScript, Google GenAI SDK
- **Security**: Docker/Podman containers, MacOS Seatbelt sandbox
- **Testing**: Vitest, Integration tests
- **APIs**: Gemini API, Vertex AI, Google Search Grounding
- **Tools**: MCP protocol, File system operations, Shell commands